\hypertarget{stb__hexwave_8h_source}{}\doxysection{stb\+\_\+hexwave.\+h}
\label{stb__hexwave_8h_source}\index{/Users/cwb/developer/learning/graphicRenderEngine/ceres/3rdparty/stb/stb\_hexwave.h@{/Users/cwb/developer/learning/graphicRenderEngine/ceres/3rdparty/stb/stb\_hexwave.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00001}00001 \textcolor{comment}{// stb\_hexwave -\/ v0.5 -\/ public domain, initial release 2021-\/04-\/01}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00002}00002 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00003}00003 \textcolor{comment}{// A flexible anti-\/aliased (bandlimited) digital audio oscillator.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00004}00004 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00005}00005 \textcolor{comment}{// This library generates waveforms of a variety of shapes made of}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00006}00006 \textcolor{comment}{// line segments. It does not do envelopes, LFO effects, etc.; it}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00007}00007 \textcolor{comment}{// merely tries to solve the problem of generating an artifact-\/free}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00008}00008 \textcolor{comment}{// morphable digital waveform with a variety of spectra, and leaves}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00009}00009 \textcolor{comment}{// it to the user to rescale the waveform and mix multiple voices, etc.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00010}00010 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00011}00011 \textcolor{comment}{// Compiling:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00012}00012 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00013}00013 \textcolor{comment}{//   In one C/C++ file that \#includes this file, do}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00014}00014 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00015}00015 \textcolor{comment}{//      \#define STB\_HEXWAVE\_IMPLEMENTATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00016}00016 \textcolor{comment}{//      \#include "{}stb\_hexwave.h"{}}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00017}00017 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00018}00018 \textcolor{comment}{//   Optionally, \#define STB\_HEXWAVE\_STATIC before including}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00019}00019 \textcolor{comment}{//   the header to cause the definitions to be private to the}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00020}00020 \textcolor{comment}{//   implementation file (i.e. to be "{}static"{} instead of "{}extern"{}).}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00021}00021 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00022}00022 \textcolor{comment}{// Notes:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00023}00023 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00024}00024 \textcolor{comment}{//   Optionally performs memory allocation during initialization,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00025}00025 \textcolor{comment}{//   never allocates otherwise.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00026}00026 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00027}00027 \textcolor{comment}{// License:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00028}00028 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00029}00029 \textcolor{comment}{//   See end of file for license information.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00030}00030 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00031}00031 \textcolor{comment}{// Usage:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00032}00032 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00033}00033 \textcolor{comment}{//   Initialization:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00034}00034 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00035}00035 \textcolor{comment}{//     hexwave\_init(32,16,NULL); // read "{}header section"{} for alternatives}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00036}00036 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00037}00037 \textcolor{comment}{//   Create oscillator:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00038}00038 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00039}00039 \textcolor{comment}{//     HexWave *osc = malloc(sizeof(*osc)); // or "{}new HexWave"{}, or declare globally or on stack}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00040}00040 \textcolor{comment}{//     hexwave\_create(osc, reflect\_flag, peak\_time, half\_height, zero\_wait);}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00041}00041 \textcolor{comment}{//       see "{}Waveform shapes"{} below for the meaning of these parameters}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00042}00042 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00043}00043 \textcolor{comment}{//   Generate audio:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00044}00044 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00045}00045 \textcolor{comment}{//     hexwave\_generate\_samples(output, number\_of\_samples, osc, oscillator\_freq)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00046}00046 \textcolor{comment}{//       where:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00047}00047 \textcolor{comment}{//         output is a buffer where the library will store floating point audio samples}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00048}00048 \textcolor{comment}{//         number\_of\_samples is the number of audio samples to generate}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00049}00049 \textcolor{comment}{//         osc is a pointer to a Hexwave}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00050}00050 \textcolor{comment}{//         oscillator\_freq is the frequency of the oscillator divided by the sample rate}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00051}00051 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00052}00052 \textcolor{comment}{//       The output samples will continue from where the samples generated by the}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00053}00053 \textcolor{comment}{//       previous hexwave\_generate\_samples() on this oscillator ended.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00054}00054 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00055}00055 \textcolor{comment}{//   Change oscillator waveform:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00056}00056 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00057}00057 \textcolor{comment}{//     hexwave\_change(osc, reflect\_flag, peak\_time, half\_height, zero\_wait);}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00058}00058 \textcolor{comment}{//       can call in between calls to hexwave\_generate\_samples}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00059}00059 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00060}00060 \textcolor{comment}{// Waveform shapes:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00061}00061 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00062}00062 \textcolor{comment}{//   All waveforms generated by hexwave are constructed from six line segments}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00063}00063 \textcolor{comment}{//   characterized by 3 parameters.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00064}00064 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00065}00065 \textcolor{comment}{//   See demonstration: https://www.youtube.com/watch?v=hsUCrAsDN-\/M}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00066}00066 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00067}00067 \textcolor{comment}{//                 reflect=0                          reflect=1}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00068}00068 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00069}00069 \textcolor{comment}{//           0-\/-\/-\/-\/-\/P-\/-\/-\/1                        0-\/-\/-\/-\/-\/P-\/-\/-\/1    peak\_time = P}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00070}00070 \textcolor{comment}{//                 .     1                            .     1}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00071}00071 \textcolor{comment}{//                /\(\backslash\)\_    :                           /\(\backslash\)\_    :}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00072}00072 \textcolor{comment}{//               /   \(\backslash\)\_  :                          /   \(\backslash\)\_  :}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00073}00073 \textcolor{comment}{//              /      \(\backslash\).H                         /      \(\backslash\).H  half\_height = H}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00074}00074 \textcolor{comment}{//             /       | :                        /       | :}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00075}00075 \textcolor{comment}{//       \_\_\_\_\_/        |\_:\_\_\_               \_\_\_\_\_/        | :       \_\_\_\_\_}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00076}00076 \textcolor{comment}{//           .           :   \(\backslash\)        |         .         | :      /}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00077}00077 \textcolor{comment}{//           .           :    \(\backslash\)       |         .         | :     /}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00078}00078 \textcolor{comment}{//           .           :     \(\backslash\)     \_/         .         \(\backslash\)\_:    /}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00079}00079 \textcolor{comment}{//           .           :      \(\backslash\)  \_/           .           :\_  /}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00080}00080 \textcolor{comment}{//           .          -\/1       \(\backslash\)/             .          -\/1 \(\backslash\)/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00081}00081 \textcolor{comment}{//       0 -\/ Z -\/ -\/ -\/ -\/ 1                    0 -\/ Z -\/ -\/ -\/ -\/ 1   zero\_wait = Z}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00082}00082 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00083}00083 \textcolor{comment}{//    Classic waveforms:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00084}00084 \textcolor{comment}{//                               peak    half    zero}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00085}00085 \textcolor{comment}{//                     reflect   time   height   wait}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00086}00086 \textcolor{comment}{//      Sawtooth          1       0       0       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00087}00087 \textcolor{comment}{//      Square            1       0       1       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00088}00088 \textcolor{comment}{//      Triangle          1       0.5     0       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00089}00089 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00090}00090 \textcolor{comment}{//    Some waveforms can be produced in multiple ways, which is useful when morphing}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00091}00091 \textcolor{comment}{//    into other waveforms, and there are a few more notable shapes:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00092}00092 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00093}00093 \textcolor{comment}{//                               peak    half    zero}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00094}00094 \textcolor{comment}{//                     reflect   time   height   wait}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00095}00095 \textcolor{comment}{//      Sawtooth          1       1      any      0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00096}00096 \textcolor{comment}{//      Sawtooth (8va)    1       0      -\/1       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00097}00097 \textcolor{comment}{//      Triangle          1       0.5     0       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00098}00098 \textcolor{comment}{//      Square            1       0       1       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00099}00099 \textcolor{comment}{//      Square            0       0       1       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00100}00100 \textcolor{comment}{//      Triangle          0       0.5     0       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00101}00101 \textcolor{comment}{//      Triangle          0       0      -\/1       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00102}00102 \textcolor{comment}{//      AlternatingSaw    0       0       0       0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00103}00103 \textcolor{comment}{//      AlternatingSaw    0       1      any      0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00104}00104 \textcolor{comment}{//      Stairs            0       0       1       0.5}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00105}00105 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00106}00106 \textcolor{comment}{//    The "{}Sawtooth (8va)"{} waveform is identical to a sawtooth wave with 2x the}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00107}00107 \textcolor{comment}{//    frequency, but when morphed with other values, it becomes an overtone of}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00108}00108 \textcolor{comment}{//    the base frequency.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00109}00109 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00110}00110 \textcolor{comment}{//  Morphing waveforms:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00111}00111 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00112}00112 \textcolor{comment}{//    Sweeping peak\_time morphs the waveform while producing various spectra.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00113}00113 \textcolor{comment}{//    Sweeping half\_height effectively crossfades between two waveforms; useful, but less exciting.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00114}00114 \textcolor{comment}{//    Sweeping zero\_wait produces a similar effect no matter the reset of the waveform,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00115}00115 \textcolor{comment}{//        a sort of high-\/pass/PWM effect where the wave becomes silent at zero\_wait=1.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00116}00116 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00117}00117 \textcolor{comment}{//    You can trivially morph between any two waveforms from the above table}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00118}00118 \textcolor{comment}{//    which only differ in one column.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00119}00119 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00120}00120 \textcolor{comment}{//    Crossfade between classic waveforms:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00121}00121 \textcolor{comment}{//                                            peak     half    zero}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00122}00122 \textcolor{comment}{//        Start         End         reflect   time    height   wait}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00123}00123 \textcolor{comment}{//        -\/-\/-\/-\/-\/         -\/-\/-\/         -\/-\/-\/-\/-\/-\/-\/   -\/-\/-\/-\/    -\/-\/-\/-\/-\/-\/   -\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00124}00124 \textcolor{comment}{//        Triangle      Square         0       0      -\/1..1    0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00125}00125 \textcolor{comment}{//        Saw           Square         1       0       0..1    0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00126}00126 \textcolor{comment}{//        Triangle      Saw            1       0.5     0..2    0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00127}00127 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00128}00128 \textcolor{comment}{//    The last morph uses uses half-\/height values larger than 1, which means it will}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00129}00129 \textcolor{comment}{//    be louder and the output should be scaled down by half to compensate, or better}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00130}00130 \textcolor{comment}{//    by dynamically tracking the morph: volume\_scale = 1 -\/ half\_height/4}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00131}00131 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00132}00132 \textcolor{comment}{//    Non-\/crossfade morph between classic waveforms, most require changing}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00133}00133 \textcolor{comment}{//    two parameters at the same time:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00134}00134 \textcolor{comment}{//                                           peak     half    zero}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00135}00135 \textcolor{comment}{//      Start         End         reflect    time    height   wait}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00136}00136 \textcolor{comment}{//      -\/-\/-\/-\/-\/         -\/-\/-\/         -\/-\/-\/-\/-\/-\/-\/    -\/-\/-\/-\/    -\/-\/-\/-\/-\/-\/   -\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00137}00137 \textcolor{comment}{//      Square        Triangle      any      0..0.5   1..0     0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00138}00138 \textcolor{comment}{//      Square        Saw            1       0..1     1..any   0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00139}00139 \textcolor{comment}{//      Triangle      Saw            1     0.5..1     0..-\/1    0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00140}00140 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00141}00141 \textcolor{comment}{//    Other noteworthy morphs between simple shapes:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00142}00142 \textcolor{comment}{//                                                            peak     half    zero}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00143}00143 \textcolor{comment}{//      Start           Halfway       End          reflect    time    height   wait}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00144}00144 \textcolor{comment}{//      -\/-\/-\/-\/-\/           -\/-\/-\/-\/-\/-\/-\/-\/-\/     -\/-\/-\/          -\/-\/-\/-\/-\/-\/-\/    -\/-\/-\/-\/    -\/-\/-\/-\/-\/-\/   -\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00145}00145 \textcolor{comment}{//      Saw (8va,neg)                Saw (pos)        1       0..1      -\/1      0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00146}00146 \textcolor{comment}{//      Saw (neg)                    Saw (pos)        1       0..1       0      0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00147}00147 \textcolor{comment}{//      Triangle                     AlternatingSaw   0       0..1      -\/1      0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00148}00148 \textcolor{comment}{//      AlternatingSaw  Triangle     AlternatingSaw   0       0..1       0      0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00149}00149 \textcolor{comment}{//      Square                       AlternatingSaw   0       0..1       1      0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00150}00150 \textcolor{comment}{//      Triangle        Triangle     AlternatingSaw   0       0..1    -\/1..1     0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00151}00151 \textcolor{comment}{//      Square                       AlternatingSaw   0       0..1     1..0     0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00152}00152 \textcolor{comment}{//      Saw (8va)       Triangle     Saw              1       0..1    -\/1..1     0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00153}00153 \textcolor{comment}{//      Saw (neg)                    Saw (pos)        1       0..1     0..1     0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00154}00154 \textcolor{comment}{//      AlternatingSaw               AlternatingSaw   0       0..1     0..any   0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00155}00155 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00156}00156 \textcolor{comment}{//   The last entry is noteworthy because the morph from the halfway point to either}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00157}00157 \textcolor{comment}{//   endpoint sounds very different. For example, an LFO sweeping back and forth over}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00158}00158 \textcolor{comment}{//   the whole range will morph between the middle timbre and the AlternatingSaw}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00159}00159 \textcolor{comment}{//   timbre in two different ways, alternating.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00160}00160 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00161}00161 \textcolor{comment}{//   Entries with "{}any"{} for half\_height are whole families of morphs, as you can pick}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00162}00162 \textcolor{comment}{//   any value you want as the endpoint for half\_height.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00163}00163 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00164}00164 \textcolor{comment}{//   You can always morph between any two waveforms with the same value of 'reflect'}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00165}00165 \textcolor{comment}{//   by just sweeping the parameters simultaneously. There will never be artifacts}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00166}00166 \textcolor{comment}{//   and the result will always be useful, if not necessarily what you want.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00167}00167 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00168}00168 \textcolor{comment}{//   You can vary the sound of two-\/parameter morphs by ramping them differently,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00169}00169 \textcolor{comment}{//   e.g. if the morph goes from t=0..1, then square-\/to-\/triangle looks like:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00170}00170 \textcolor{comment}{//        peak\_time   = lerp(t, 0, 0.5)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00171}00171 \textcolor{comment}{//        half\_height = lerp(t, 1, 0  )}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00172}00172 \textcolor{comment}{//   but you can also do things like:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00173}00173 \textcolor{comment}{//        peak\_time   = lerp(smoothstep(t), 0, 0.5)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00174}00174 \textcolor{comment}{//        half\_height = cos(PI/2 * t)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00175}00175 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00176}00176 \textcolor{comment}{// How it works:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00177}00177 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00178}00178 \textcolor{comment}{//   hexwave use BLEP to bandlimit discontinuities and BLAMP}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00179}00179 \textcolor{comment}{//   to bandlimit C1 discontinuities. This is not polyBLEP}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00180}00180 \textcolor{comment}{//   (polynomial BLEP), it is table-\/driven BLEP. It is}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00181}00181 \textcolor{comment}{//   also not minBLEP (minimum-\/phase BLEP), as that complicates}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00182}00182 \textcolor{comment}{//   things for little benefit once BLAMP is involved.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00183}00183 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00184}00184 \textcolor{comment}{//   The previous oscillator frequency is remembered, and when}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00185}00185 \textcolor{comment}{//   the frequency changes, a BLAMP is generated to remove the}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00186}00186 \textcolor{comment}{//   C1 discontinuity, which reduces artifacts for sweeps/LFO.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00187}00187 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00188}00188 \textcolor{comment}{//   Changes to an oscillator timbre using hexwave\_change() actually}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00189}00189 \textcolor{comment}{//   wait until the oscillator finishes its current cycle. All}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00190}00190 \textcolor{comment}{//   waveforms with non-\/zero "{}zero\_wait"{} settings pass through 0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00191}00191 \textcolor{comment}{//   and have 0-\/slope at the start of a cycle, which means changing}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00192}00192 \textcolor{comment}{//   the settings is artifact free at that time. (If zero\_wait is 0,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00193}00193 \textcolor{comment}{//   the code still treats it as passing through 0 with 0-\/slope; it'll}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00194}00194 \textcolor{comment}{//   apply the necessary fixups to make it artifact free as if it does}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00195}00195 \textcolor{comment}{//   transition to 0 with 0-\/slope vs. the waveform at the end of}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00196}00196 \textcolor{comment}{//   the cycle, then adds the fixups for a non-\/0 and non-\/0 slope}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00197}00197 \textcolor{comment}{//   at the start of the cycle, which cancels out if zero\_wait is 0,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00198}00198 \textcolor{comment}{//   and still does the right thing if zero\_wait is 0 when the}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00199}00199 \textcolor{comment}{//   settings are updated.)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00200}00200 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00201}00201 \textcolor{comment}{//   BLEP/BLAMP normally requires overlapping buffers, but this}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00202}00202 \textcolor{comment}{//   is hidden from the user by generating the waveform to a}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00203}00203 \textcolor{comment}{//   temporary buffer and saving the overlap regions internally}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00204}00204 \textcolor{comment}{//   between calls. (It is slightly more complicated; see code.)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00205}00205 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00206}00206 \textcolor{comment}{//   By design all shapes have 0 DC offset; this is one reason}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00207}00207 \textcolor{comment}{//   hexwave uses zero\_wait instead of standard PWM.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00208}00208 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00209}00209 \textcolor{comment}{//   The internals of hexwave could support any arbitrary shape}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00210}00210 \textcolor{comment}{//   made of line segments, but I chose not to expose this}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00211}00211 \textcolor{comment}{//   generality in favor of a simple, easy-\/to-\/use API.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00212}00212 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00213}00213 \textcolor{preprocessor}{\#ifndef STB\_INCLUDE\_STB\_HEXWAVE\_H}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00214}00214 \textcolor{preprocessor}{\#define STB\_INCLUDE\_STB\_HEXWAVE\_H}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00215}00215 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00216}00216 \textcolor{preprocessor}{\#ifndef STB\_HEXWAVE\_MAX\_BLEP\_LENGTH}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00217}00217 \textcolor{preprocessor}{\#define STB\_HEXWAVE\_MAX\_BLEP\_LENGTH   64 }\textcolor{comment}{// good enough for anybody}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00218}00218 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00219}00219 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00220}00220 \textcolor{preprocessor}{\#ifdef STB\_HEXWAVE\_STATIC}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00221}00221 \textcolor{preprocessor}{\#define STB\_HEXWAVE\_DEF static}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00222}00222 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00223}00223 \textcolor{preprocessor}{\#define STB\_HEXWAVE\_DEF extern}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00224}00224 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00225}00225 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00226}00226 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_hex_wave}{HexWave}} \mbox{\hyperlink{struct_hex_wave}{HexWave}};}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00227}00227 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00228}00228 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_init(\textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} oversample, \textcolor{keywordtype}{float} *user\_buffer);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00229}00229 \textcolor{comment}{//         width: size of BLEP, from 4..64, larger is slower \& more memory but less aliasing}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00230}00230 \textcolor{comment}{//    oversample: 2+, number of subsample positions, larger uses more memory but less noise}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00231}00231 \textcolor{comment}{//   user\_buffer: optional, if provided the library will perform no allocations.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00232}00232 \textcolor{comment}{//                16*width*(oversample+1) bytes, must stay allocated as long as library is used}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00233}00233 \textcolor{comment}{//                technically it only needs:   8*( width * (oversample  + 1))}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00234}00234 \textcolor{comment}{//                                           + 8*((width *  oversample) + 1)  bytes}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00235}00235 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00236}00236 \textcolor{comment}{// width can be larger than 64 if you define STB\_HEXWAVE\_MAX\_BLEP\_LENGTH to a larger value}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00238}00238 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_shutdown(\textcolor{keywordtype}{float} *user\_buffer);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00239}00239 \textcolor{comment}{//       user\_buffer: pass in same parameter as passed to hexwave\_init}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00240}00240 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00241}00241 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_create(\mbox{\hyperlink{struct_hex_wave}{HexWave}} *hex, \textcolor{keywordtype}{int} reflect, \textcolor{keywordtype}{float} peak\_time, \textcolor{keywordtype}{float} half\_height, \textcolor{keywordtype}{float} zero\_wait);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00242}00242 \textcolor{comment}{// see docs above for description}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00243}00243 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00244}00244 \textcolor{comment}{//   reflect is tested as 0 or non-\/zero}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00245}00245 \textcolor{comment}{//   peak\_time is clamped to 0..1}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00246}00246 \textcolor{comment}{//   half\_height is not clamped}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00247}00247 \textcolor{comment}{//   zero\_wait is clamped to 0..1}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00249}00249 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_change(\mbox{\hyperlink{struct_hex_wave}{HexWave}} *hex, \textcolor{keywordtype}{int} reflect, \textcolor{keywordtype}{float} peak\_time, \textcolor{keywordtype}{float} half\_height, \textcolor{keywordtype}{float} zero\_wait);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00250}00250 \textcolor{comment}{// see docs}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00251}00251 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00252}00252 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_generate\_samples(\textcolor{keywordtype}{float} *\mbox{\hyperlink{structoutput}{output}}, \textcolor{keywordtype}{int} num\_samples, \mbox{\hyperlink{struct_hex_wave}{HexWave}} *hex, \textcolor{keywordtype}{float} freq);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00253}00253 \textcolor{comment}{//            output: buffer where the library will store generated floating point audio samples}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00254}00254 \textcolor{comment}{// number\_of\_samples: the number of audio samples to generate}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00255}00255 \textcolor{comment}{//               osc: pointer to a Hexwave initialized with 'hexwave\_create'}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00256}00256 \textcolor{comment}{//   oscillator\_freq: frequency of the oscillator divided by the sample rate}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00257}00257 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00258}00258 \textcolor{comment}{// private:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00259}\mbox{\hyperlink{struct_hex_wave_parameters}{00259}} \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00260}00260 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00261}00261    \textcolor{keywordtype}{int}   reflect;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00262}00262    \textcolor{keywordtype}{float} peak\_time;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00263}00263    \textcolor{keywordtype}{float} zero\_wait;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00264}00264    \textcolor{keywordtype}{float} half\_height;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00265}00265 \} \mbox{\hyperlink{struct_hex_wave_parameters}{HexWaveParameters}};}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00266}00266 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00267}\mbox{\hyperlink{struct_hex_wave}{00267}} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_hex_wave}{HexWave}}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00268}00268 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00269}00269    \textcolor{keywordtype}{float} t, prev\_dt;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00270}00270    \mbox{\hyperlink{struct_hex_wave_parameters}{HexWaveParameters}} current, pending;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00271}00271    \textcolor{keywordtype}{int} have\_pending;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00272}00272    \textcolor{keywordtype}{float} \mbox{\hyperlink{classbuffer}{buffer}}[STB\_HEXWAVE\_MAX\_BLEP\_LENGTH];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00273}00273 \}; }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00274}00274 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00276}00276 \textcolor{preprocessor}{\#ifdef STB\_HEXWAVE\_IMPLEMENTATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00278}00278 \textcolor{preprocessor}{\#ifndef STB\_HEXWAVE\_NO\_ALLOCATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00279}00279 \textcolor{preprocessor}{\#include <stdlib.h>} \textcolor{comment}{// malloc,free}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00280}00280 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00282}00282 \textcolor{preprocessor}{\#include <string.h>} \textcolor{comment}{// memset,memcpy,memmove}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00283}00283 \textcolor{preprocessor}{\#include <math.h>}   \textcolor{comment}{// sin,cos,fabs}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00285}00285 \textcolor{preprocessor}{\#define hexwave\_clamp(v,a,b)   ((v) < (a) ? (a) : (v) > (b) ? (b) : (v))}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00287}00287 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_change(\mbox{\hyperlink{struct_hex_wave}{HexWave}} *hex, \textcolor{keywordtype}{int} reflect, \textcolor{keywordtype}{float} peak\_time, \textcolor{keywordtype}{float} half\_height, \textcolor{keywordtype}{float} zero\_wait)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00288}00288 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00289}00289    hex-\/>pending.reflect     = reflect;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00290}00290    hex-\/>pending.peak\_time   = hexwave\_clamp(peak\_time,0,1);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00291}00291    hex-\/>pending.half\_height = half\_height;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00292}00292    hex-\/>pending.zero\_wait   = hexwave\_clamp(zero\_wait,0,1);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00293}00293    \textcolor{comment}{// put a barrier here to allow changing from a different thread than the generator}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00294}00294    hex-\/>have\_pending        = 1;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00295}00295 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00296}00296 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00297}00297 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_create(\mbox{\hyperlink{struct_hex_wave}{HexWave}} *hex, \textcolor{keywordtype}{int} reflect, \textcolor{keywordtype}{float} peak\_time, \textcolor{keywordtype}{float} half\_height, \textcolor{keywordtype}{float} zero\_wait)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00298}00298 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00299}00299    memset(hex, 0, \textcolor{keyword}{sizeof}(*hex));}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00300}00300    hexwave\_change(hex, reflect, peak\_time, half\_height, zero\_wait);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00301}00301    hex-\/>current = hex-\/>pending;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00302}00302    hex-\/>have\_pending = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00303}00303    hex-\/>t = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00304}00304    hex-\/>prev\_dt = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00305}00305 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00307}00307 \textcolor{keyword}{static} \textcolor{keyword}{struct}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00308}00308 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00309}00309    \textcolor{keywordtype}{int} width;       \textcolor{comment}{// width of fixup in samples}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00310}00310    \textcolor{keywordtype}{int} oversample;  \textcolor{comment}{// number of oversampled versions (there's actually one more to allow lerpign)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00311}00311    \textcolor{keywordtype}{float} *blep;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00312}00312    \textcolor{keywordtype}{float} *blamp;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00313}00313 \} hexblep;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00314}00314 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00315}00315 \textcolor{keyword}{static} \textcolor{keywordtype}{void} hex\_add\_oversampled\_bleplike(\textcolor{keywordtype}{float} *\mbox{\hyperlink{structoutput}{output}}, \textcolor{keywordtype}{float} time\_since\_transition, \textcolor{keywordtype}{float} scale, \textcolor{keywordtype}{float} *data)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00316}00316 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00317}00317    \textcolor{keywordtype}{float} *d1,*d2;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00318}00318    \textcolor{keywordtype}{float} lerpweight;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00319}00319    \textcolor{keywordtype}{int} i, bw = hexblep.width;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00320}00320 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00321}00321    \textcolor{keywordtype}{int} slot = (int) (time\_since\_transition * hexblep.oversample);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00322}00322    \textcolor{keywordflow}{if} (slot >= hexblep.oversample)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00323}00323       slot = hexblep.oversample-\/1; \textcolor{comment}{// clamp in case the floats overshoot}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00324}00324 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00325}00325    d1 = \&data[ slot   *bw];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00326}00326    d2 = \&data[(slot+1)*bw];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00327}00327 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00328}00328    lerpweight = time\_since\_transition * hexblep.oversample -\/ slot;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00329}00329    \textcolor{keywordflow}{for} (i=0; i < bw; ++i)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00330}00330       \mbox{\hyperlink{structoutput}{output}}[i] += scale * (d1[i] + (d2[i]-\/d1[i])*lerpweight);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00331}00331 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00332}00332 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00333}00333 \textcolor{keyword}{static} \textcolor{keywordtype}{void} hex\_blep (\textcolor{keywordtype}{float} *\mbox{\hyperlink{structoutput}{output}}, \textcolor{keywordtype}{float} time\_since\_transition, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00334}00334 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00335}00335    hex\_add\_oversampled\_bleplike(\mbox{\hyperlink{structoutput}{output}}, time\_since\_transition, scale, hexblep.blep);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00336}00336 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00338}00338 \textcolor{keyword}{static} \textcolor{keywordtype}{void} hex\_blamp(\textcolor{keywordtype}{float} *\mbox{\hyperlink{structoutput}{output}}, \textcolor{keywordtype}{float} time\_since\_transition, \textcolor{keywordtype}{float} scale)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00339}00339 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00340}00340    hex\_add\_oversampled\_bleplike(\mbox{\hyperlink{structoutput}{output}}, time\_since\_transition, scale, hexblep.blamp);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00341}00341 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00342}00342 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00343}00343 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00344}00344 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00345}00345    \textcolor{keywordtype}{float} t,v,s; \textcolor{comment}{// time, value, slope}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00346}00346 \} hexvert;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00347}00347 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00348}00348 \textcolor{comment}{// each half of the waveform needs 4 vertices to represent 3 line}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00349}00349 \textcolor{comment}{// segments, plus 1 more for wraparound}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00350}00350 \textcolor{keyword}{static} \textcolor{keywordtype}{void} hexwave\_generate\_linesegs(hexvert vert[9], \mbox{\hyperlink{struct_hex_wave}{HexWave}} *hex, \textcolor{keywordtype}{float} dt)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00351}00351 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00352}00352    \textcolor{keywordtype}{int} j;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00353}00353    \textcolor{keywordtype}{float} min\_len = dt / 256.0f;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00354}00354 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00355}00355    vert[0].t = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00356}00356    vert[0].v = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00357}00357    vert[1].t = hex-\/>current.zero\_wait*0.5f;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00358}00358    vert[1].v = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00359}00359    vert[2].t = 0.5f*hex-\/>current.peak\_time + vert[1].t*(1-\/hex-\/>current.peak\_time);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00360}00360    vert[2].v = 1;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00361}00361    vert[3].t = 0.5f;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00362}00362    vert[3].v = hex-\/>current.half\_height;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00364}00364    \textcolor{keywordflow}{if} (hex-\/>current.reflect) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00365}00365       \textcolor{keywordflow}{for} (j=4; j <= 7; ++j) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00366}00366          vert[j].t = 1 -\/  vert[7-\/j].t;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00367}00367          vert[j].v =    -\/ vert[7-\/j].v;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00368}00368       \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00369}00369    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00370}00370       \textcolor{keywordflow}{for} (j=4; j <= 7; ++j) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00371}00371          vert[j].t =  0.5f +  vert[j-\/4].t;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00372}00372          vert[j].v =        -\/ vert[j-\/4].v;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00373}00373       \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00374}00374    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00375}00375    vert[8].t = 1;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00376}00376    vert[8].v = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00377}00377 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00378}00378    \textcolor{keywordflow}{for} (j=0; j < 8; ++j) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00379}00379       \textcolor{keywordflow}{if} (vert[j+1].t <= vert[j].t + min\_len) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00380}00380           \textcolor{comment}{// if change takes place over less than a fraction of a sample treat as discontinuity}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00381}00381           \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00382}00382           \textcolor{comment}{// otherwise the slope computation can blow up to arbitrarily large and we}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00383}00383           \textcolor{comment}{// try to generate a huge BLAMP and the result is wrong.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00384}00384           \textcolor{comment}{// }}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00385}00385           \textcolor{comment}{// why does this happen if the math is right? i believe if done perfectly,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00386}00386           \textcolor{comment}{// the two BLAMPs on either side of the slope would cancel out, but our}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00387}00387           \textcolor{comment}{// BLAMPs have only limited sub-\/sample precision and limited integration}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00388}00388           \textcolor{comment}{// accuracy. or maybe it's just the math blowing up w/ floating point precision}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00389}00389           \textcolor{comment}{// limits as we try to make x * (1/x) cancel out}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00390}00390           \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00391}00391           \textcolor{comment}{// min\_len verified artifact-\/free even near nyquist with only oversample=4}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00392}00392          vert[j+1].t = vert[j].t;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00393}00393       \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00394}00394    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00396}00396    \textcolor{keywordflow}{if} (vert[8].t != 1.0f) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00397}00397       \textcolor{comment}{// if the above fixup moved the endpoint away from 1.0, move it back,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00398}00398       \textcolor{comment}{// along with any other vertices that got moved to the same time}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00399}00399       \textcolor{keywordtype}{float} t = vert[8].t;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00400}00400       \textcolor{keywordflow}{for} (j=5; j <= 8; ++j)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00401}00401          \textcolor{keywordflow}{if} (vert[j].t == t)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00402}00402             vert[j].t = 1.0f;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00403}00403    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00405}00405    \textcolor{comment}{// compute the exact slopes from the final fixed-\/up positions}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00406}00406    \textcolor{keywordflow}{for} (j=0; j < 8; ++j)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00407}00407       \textcolor{keywordflow}{if} (vert[j+1].t == vert[j].t)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00408}00408          vert[j].s = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00409}00409       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00410}00410          vert[j].s = (vert[j+1].v -\/ vert[j].v) / (vert[j+1].t -\/ vert[j].t);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00412}00412    \textcolor{comment}{// wraparound at end}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00413}00413    vert[8].t = 1;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00414}00414    vert[8].v = vert[0].v;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00415}00415    vert[8].s = vert[0].s;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00416}00416 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00418}00418 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_generate\_samples(\textcolor{keywordtype}{float} *\mbox{\hyperlink{structoutput}{output}}, \textcolor{keywordtype}{int} num\_samples, \mbox{\hyperlink{struct_hex_wave}{HexWave}} *hex, \textcolor{keywordtype}{float} freq)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00419}00419 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00420}00420    hexvert vert[9];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00421}00421    \textcolor{keywordtype}{int} pass,i,j;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00422}00422    \textcolor{keywordtype}{float} t = hex-\/>t;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00423}00423    \textcolor{keywordtype}{float} temp\_output[2*STB\_HEXWAVE\_MAX\_BLEP\_LENGTH];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00424}00424    \textcolor{keywordtype}{int} buffered\_length = \textcolor{keyword}{sizeof}(float)*hexblep.width;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00425}00425    \textcolor{keywordtype}{float} dt = (\textcolor{keywordtype}{float}) fabs(freq);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00426}00426    \textcolor{keywordtype}{float} recip\_dt = (dt == 0.0f) ? 0.0f : 1.0f / dt;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00428}00428    \textcolor{keywordtype}{int} halfw = hexblep.width/2;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00429}00429    \textcolor{comment}{// all sample times are biased by halfw to leave room for BLEP/BLAMP to go back in time}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00431}00431    \textcolor{keywordflow}{if} (num\_samples <= 0)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00432}00432       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00433}00433 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00434}00434    \textcolor{comment}{// convert parameters to times and slopes}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00435}00435    hexwave\_generate\_linesegs(vert, hex, dt);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00437}00437    \textcolor{keywordflow}{if} (hex-\/>prev\_dt != dt) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00438}00438       \textcolor{comment}{// if frequency changes, add a fixup at the derivative discontinuity starting at now}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00439}00439       \textcolor{keywordtype}{float} slope;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00440}00440       \textcolor{keywordflow}{for} (j=1; j < 6; ++j)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00441}00441          \textcolor{keywordflow}{if} (t < vert[j].t)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00442}00442             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00443}00443       slope = vert[j].s;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00444}00444       \textcolor{keywordflow}{if} (slope != 0)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00445}00445          hex\_blamp(\mbox{\hyperlink{structoutput}{output}}, 0, (dt -\/ hex-\/>prev\_dt)*slope);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00446}00446       hex-\/>prev\_dt = dt;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00447}00447    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00448}00448 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00449}00449    \textcolor{comment}{// copy the buffered data from last call and clear the rest of the output array}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00450}00450    memset(\mbox{\hyperlink{structoutput}{output}}, 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*num\_samples);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00451}00451    memset(temp\_output, 0, 2*hexblep.width*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}));}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00452}00452 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00453}00453    \textcolor{keywordflow}{if} (num\_samples >= hexblep.width) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00454}00454       memcpy(\mbox{\hyperlink{structoutput}{output}}, hex-\/>buffer, buffered\_length);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00455}00455    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00456}00456       \textcolor{comment}{// if the output is shorter than hexblep.width, we do all synthesis to temp\_output}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00457}00457       memcpy(temp\_output, hex-\/>buffer, buffered\_length);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00458}00458    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00459}00459 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00460}00460    \textcolor{keywordflow}{for} (pass=0; pass < 2; ++pass) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00461}00461       \textcolor{keywordtype}{int} i0,i1;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00462}00462       \textcolor{keywordtype}{float} *out;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00464}00464       \textcolor{comment}{// we want to simulate having one buffer that is num\_output + hexblep.width}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00465}00465       \textcolor{comment}{// samples long, without putting that requirement on the user, and without}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00466}00466       \textcolor{comment}{// allocating a temp buffer that's as long as the whole thing. so we use two}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00467}00467       \textcolor{comment}{// overlapping buffers, one the user's buffer and one a fixed-\/length temp}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00468}00468       \textcolor{comment}{// buffer.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00469}00469 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00470}00470       \textcolor{keywordflow}{if} (pass == 0) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00471}00471          \textcolor{keywordflow}{if} (num\_samples < hexblep.width)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00472}00472             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00473}00473          \textcolor{comment}{// run as far as we can without overwriting the end of the user's buffer }}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00474}00474          out = \mbox{\hyperlink{structoutput}{output}};}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00475}00475          i0 = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00476}00476          i1 = num\_samples -\/ hexblep.width;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00477}00477       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00478}00478          \textcolor{comment}{// generate the rest into a temp buffer}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00479}00479          out = temp\_output;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00480}00480          i0 = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00481}00481          \textcolor{keywordflow}{if} (num\_samples >= hexblep.width)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00482}00482             i1 = hexblep.width;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00483}00483          \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00484}00484             i1 = num\_samples;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00485}00485       \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00486}00486 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00487}00487       \textcolor{comment}{// determine current segment}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00488}00488       \textcolor{keywordflow}{for} (j=0; j < 8; ++j)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00489}00489          \textcolor{keywordflow}{if} (t < vert[j+1].t)                                  }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00490}00490             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00491}00491 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00492}00492       i = i0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00493}00493       \textcolor{keywordflow}{for}(;;) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00494}00494          \textcolor{keywordflow}{while} (t < vert[j+1].t) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00495}00495             \textcolor{keywordflow}{if} (i == i1)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00496}00496                \textcolor{keywordflow}{goto} done;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00497}00497             out[i+halfw] += vert[j].v + vert[j].s*(t -\/ vert[j].t);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00498}00498             t += dt;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00499}00499             ++i;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00500}00500          \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00501}00501          \textcolor{comment}{// transition from lineseg starting at j to lineseg starting at j+1}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00503}00503          \textcolor{keywordflow}{if} (vert[j].t == vert[j+1].t)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00504}00504             hex\_blep(out+i, recip\_dt*(t-\/vert[j+1].t), (vert[j+1].v -\/ vert[j].v));}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00505}00505          hex\_blamp(out+i, recip\_dt*(t-\/vert[j+1].t), dt*(vert[j+1].s -\/ vert[j].s));}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00506}00506          ++j;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00507}00507 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00508}00508          \textcolor{keywordflow}{if} (j == 8) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00509}00509             \textcolor{comment}{// change to different waveform if there's a change pending}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00510}00510             j = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00511}00511             t -\/= 1.0; \textcolor{comment}{// t was >= 1.f if j==8}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00512}00512             \textcolor{keywordflow}{if} (hex-\/>have\_pending) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00513}00513                \textcolor{keywordtype}{float} prev\_s0 = vert[j].s;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00514}00514                \textcolor{keywordtype}{float} prev\_v0 = vert[j].v;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00515}00515                hex-\/>current = hex-\/>pending;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00516}00516                hex-\/>have\_pending = 0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00517}00517                hexwave\_generate\_linesegs(vert, hex, dt);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00518}00518                \textcolor{comment}{// the following never occurs with this oscillator, but it makes}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00519}00519                \textcolor{comment}{// the code work in more general cases}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00520}00520                \textcolor{keywordflow}{if} (vert[j].v != prev\_v0)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00521}00521                   hex\_blep (out+i, recip\_dt*t,    (vert[j].v -\/ prev\_v0));}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00522}00522                \textcolor{keywordflow}{if} (vert[j].s != prev\_s0)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00523}00523                   hex\_blamp(out+i, recip\_dt*t, dt*(vert[j].s -\/ prev\_s0));}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00524}00524             \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00525}00525          \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00526}00526       \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00527}00527      done:}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00528}00528       ;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00529}00529    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00530}00530 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00531}00531    \textcolor{comment}{// at this point, we've written output[] and temp\_output[]}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00532}00532    \textcolor{keywordflow}{if} (num\_samples >= hexblep.width) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00533}00533       \textcolor{comment}{// the first half of temp[] overlaps the end of output, the second half will be the new start overlap}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00534}00534       \textcolor{keywordflow}{for} (i=0; i < hexblep.width; ++i)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00535}00535          \mbox{\hyperlink{structoutput}{output}}[num\_samples-\/hexblep.width + i] += temp\_output[i];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00536}00536       memcpy(hex-\/>buffer, temp\_output+hexblep.width, buffered\_length);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00537}00537    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00538}00538       \textcolor{keywordflow}{for} (i=0; i < num\_samples; ++i)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00539}00539          \mbox{\hyperlink{structoutput}{output}}[i] = temp\_output[i];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00540}00540       memcpy(hex-\/>buffer, temp\_output+num\_samples, buffered\_length);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00541}00541    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00542}00542 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00543}00543    hex-\/>t = t;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00544}00544 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00545}00545 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00546}00546 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_shutdown(\textcolor{keywordtype}{float} *user\_buffer)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00547}00547 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00548}00548 \textcolor{preprocessor}{   \#ifndef STB\_HEXWAVE\_NO\_ALLOCATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00549}00549    \textcolor{keywordflow}{if} (user\_buffer != 0) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00550}00550       free(hexblep.blep);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00551}00551       free(hexblep.blamp);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00552}00552    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00553}00553 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00554}00554 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00555}00555 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00556}00556 \textcolor{comment}{// buffer should be NULL or must be 4*(width*(oversample+1)*2 + }}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00557}00557 STB\_HEXWAVE\_DEF \textcolor{keywordtype}{void} hexwave\_init(\textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} oversample, \textcolor{keywordtype}{float} *user\_buffer)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00558}00558 \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00559}00559    \textcolor{keywordtype}{int} halfwidth = width/2;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00560}00560    \textcolor{keywordtype}{int} half = halfwidth*oversample;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00561}00561    \textcolor{keywordtype}{int} blep\_buffer\_count = width*(oversample+1);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00562}00562    \textcolor{keywordtype}{int} n = 2*half+1;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00563}00563 \textcolor{preprocessor}{\#ifdef STB\_HEXWAVE\_NO\_ALLOCATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00564}00564    \textcolor{keywordtype}{float} *buffers = user\_buffer;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00565}00565 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00566}00566    \textcolor{keywordtype}{float} *buffers = user\_buffer ? user\_buffer : (\textcolor{keywordtype}{float} *) malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float}) * n * 2);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00567}00567 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00568}00568    \textcolor{keywordtype}{float} *\mbox{\hyperlink{group__core__func__common_ga015a1261ff23e12650211aa872863cce}{step}}    = buffers+0*n;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00569}00569    \textcolor{keywordtype}{float} *ramp    = buffers+1*n;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00570}00570    \textcolor{keywordtype}{float} *blep\_buffer, *blamp\_buffer;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00571}00571    \textcolor{keywordtype}{double} integrate\_impulse=0, integrate\_step=0;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00572}00572    \textcolor{keywordtype}{int} i,j;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00573}00573 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00574}00574    \textcolor{keywordflow}{if} (width > STB\_HEXWAVE\_MAX\_BLEP\_LENGTH)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00575}00575       width = STB\_HEXWAVE\_MAX\_BLEP\_LENGTH;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00576}00576 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00577}00577    \textcolor{keywordflow}{if} (user\_buffer == 0) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00578}00578 \textcolor{preprocessor}{      \#ifndef STB\_HEXWAVE\_NO\_ALLOCATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00579}00579       blep\_buffer  = (\textcolor{keywordtype}{float} *) malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*blep\_buffer\_count);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00580}00580       blamp\_buffer = (\textcolor{keywordtype}{float} *) malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{float})*blep\_buffer\_count);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00581}00581 \textcolor{preprocessor}{      \#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00582}00582    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00583}00583       blep\_buffer  = ramp+n;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00584}00584       blamp\_buffer = blep\_buffer + blep\_buffer\_count;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00585}00585    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00586}00586 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00587}00587    \textcolor{comment}{// compute BLEP and BLAMP by integerating windowed sinc}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00588}00588    \textcolor{keywordflow}{for} (i=0; i < n; ++i) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00589}00589       \textcolor{keywordflow}{for} (j=0; j < 16; ++j) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00590}00590          \textcolor{keywordtype}{float} sinc\_t = 3.141592f* (i-\/half) / oversample;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00591}00591          \textcolor{keywordtype}{float} sinc   = (i==half) ? 1.0f : (\textcolor{keywordtype}{float}) \mbox{\hyperlink{group__core__func__trigonometric_ga3fcdcfa2d2ac38de9ba1885cd1c79414}{sin}}(sinc\_t) / (sinc\_t);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00592}00592          \textcolor{keywordtype}{float} wt     = 2.0f*3.1415926f * i / (n-\/1);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00593}00593          \textcolor{keywordtype}{float} window = (float) (0.355768 -\/ 0.487396*\mbox{\hyperlink{group__core__func__trigonometric_ga54745147add8b4fa05642f5c71f6833e}{cos}}(wt) + 0.144232*\mbox{\hyperlink{group__core__func__trigonometric_ga54745147add8b4fa05642f5c71f6833e}{cos}}(2*wt) -\/ 0.012604*\mbox{\hyperlink{group__core__func__trigonometric_ga54745147add8b4fa05642f5c71f6833e}{cos}}(3*wt)); \textcolor{comment}{// Nuttall}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00594}00594          \textcolor{keywordtype}{double} \mbox{\hyperlink{classvalue}{value}}       =         window * sinc;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00595}00595          integrate\_impulse +=         \mbox{\hyperlink{classvalue}{value}}/16;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00596}00596          integrate\_step    +=         integrate\_impulse/16;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00597}00597       \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00598}00598       \mbox{\hyperlink{group__core__func__common_ga015a1261ff23e12650211aa872863cce}{step}}[i]            = (float) integrate\_impulse;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00599}00599       ramp[i]            = (float) integrate\_step;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00600}00600    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00601}00601 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00602}00602    \textcolor{comment}{// renormalize}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00603}00603    \textcolor{keywordflow}{for} (i=0; i < n; ++i) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00604}00604       \mbox{\hyperlink{group__core__func__common_ga015a1261ff23e12650211aa872863cce}{step}}[i] = \mbox{\hyperlink{group__core__func__common_ga015a1261ff23e12650211aa872863cce}{step}}[i] * (float) (1.0       / \mbox{\hyperlink{group__core__func__common_ga015a1261ff23e12650211aa872863cce}{step}}[n-\/1]); \textcolor{comment}{// step needs to reach to 1.0}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00605}00605       ramp[i] = ramp[i] * (float) (halfwidth / ramp[n-\/1]); \textcolor{comment}{// ramp needs to become a slope of 1.0 after oversampling}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00606}00606    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00607}00607 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00608}00608    \textcolor{comment}{// deinterleave to allow efficient interpolation e.g. w/SIMD}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00609}00609    \textcolor{keywordflow}{for} (j=0; j <= oversample; ++j) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00610}00610       \textcolor{keywordflow}{for} (i=0; i < width; ++i) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00611}00611          blep\_buffer [j*width+i] = \mbox{\hyperlink{group__core__func__common_ga015a1261ff23e12650211aa872863cce}{step}}[j+i*oversample];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00612}00612          blamp\_buffer[j*width+i] = ramp[j+i*oversample];}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00613}00613       \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00614}00614    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00616}00616    \textcolor{comment}{// subtract out the naive waveform; note we can't do this to the raw data}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00617}00617    \textcolor{comment}{// above, because we want the discontinuity to be in a different locations}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00618}00618    \textcolor{comment}{// for j=0 and j=oversample (which exists to provide something to interpolate against)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00619}00619    \textcolor{keywordflow}{for} (j=0; j <= oversample; ++j) \{}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00620}00620       \textcolor{comment}{// subtract step}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00621}00621       \textcolor{keywordflow}{for} (i=halfwidth; i < width; ++i)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00622}00622          blep\_buffer [j*width+i] -\/= 1.0f;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00623}00623       \textcolor{comment}{// subtract ramp}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00624}00624       \textcolor{keywordflow}{for} (i=halfwidth; i < width; ++i)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00625}00625          blamp\_buffer[j*width+i] -\/= (j+i*oversample-\/half)*(1.0f/oversample);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00626}00626    \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00627}00627 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00628}00628    hexblep.blep  = blep\_buffer;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00629}00629    hexblep.blamp = blamp\_buffer;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00630}00630    hexblep.width = width;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00631}00631    hexblep.oversample = oversample;}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00632}00632 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00633}00633 \textcolor{preprocessor}{   \#ifndef STB\_HEXWAVE\_NO\_ALLOCATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00634}00634    \textcolor{keywordflow}{if} (user\_buffer == 0)}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00635}00635       free(buffers);}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00636}00636 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00637}00637 \}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00638}00638 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STB\_HEXWAVE\_IMPLEMENTATION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00639}00639 }
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00640}00640 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00641}00641 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00642}00642 \textcolor{comment}{This software is available under 2 licenses -\/-\/ choose whichever you prefer.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00643}00643 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00644}00644 \textcolor{comment}{ALTERNATIVE A -\/ MIT License}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00645}00645 \textcolor{comment}{Copyright (c) 2017 Sean Barrett}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00646}00646 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy of}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00647}00647 \textcolor{comment}{this software and associated documentation files (the "{}Software"{}), to deal in}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00648}00648 \textcolor{comment}{the Software without restriction, including without limitation the rights to}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00649}00649 \textcolor{comment}{use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00650}00650 \textcolor{comment}{of the Software, and to permit persons to whom the Software is furnished to do}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00651}00651 \textcolor{comment}{so, subject to the following conditions:}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00652}00652 \textcolor{comment}{The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00653}00653 \textcolor{comment}{copies or substantial portions of the Software.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00654}00654 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00655}00655 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00656}00656 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00657}00657 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00658}00658 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00659}00659 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00660}00660 \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00661}00661 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00662}00662 \textcolor{comment}{ALTERNATIVE B -\/ Public Domain (www.unlicense.org)}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00663}00663 \textcolor{comment}{This is free and unencumbered software released into the public domain.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00664}00664 \textcolor{comment}{Anyone is free to copy, modify, publish, use, compile, sell, or distribute this}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00665}00665 \textcolor{comment}{software, either in source code form or as a compiled binary, for any purpose,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00666}00666 \textcolor{comment}{commercial or non-\/commercial, and by any means.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00667}00667 \textcolor{comment}{In jurisdictions that recognize copyright laws, the author or authors of this}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00668}00668 \textcolor{comment}{software dedicate any and all copyright interest in the software to the public}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00669}00669 \textcolor{comment}{domain. We make this dedication for the benefit of the public at large and to}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00670}00670 \textcolor{comment}{the detriment of our heirs and successors. We intend this dedication to be an}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00671}00671 \textcolor{comment}{overt act of relinquishment in perpetuity of all present and future rights to}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00672}00672 \textcolor{comment}{this software under copyright law.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00673}00673 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00674}00674 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00675}00675 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00676}00676 \textcolor{comment}{AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00677}00677 \textcolor{comment}{ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00678}00678 \textcolor{comment}{WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00679}00679 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{stb__hexwave_8h_source_l00680}00680 \textcolor{comment}{*/}}

\end{DoxyCode}
