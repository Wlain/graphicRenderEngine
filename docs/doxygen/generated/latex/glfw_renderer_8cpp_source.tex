\hypertarget{glfw_renderer_8cpp_source}{}\doxysection{glfw\+Renderer.\+cpp}
\label{glfw_renderer_8cpp_source}\index{/Users/william/git/demo/graphicRenderEngine/ceres/core/glfwRenderer.cpp@{/Users/william/git/demo/graphicRenderEngine/ceres/core/glfwRenderer.cpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00001}00001 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00002}00002 \textcolor{comment}{// Created by william on 2022/5/28.}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00003}00003 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include "{}glfwRenderer.h"{}}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include "{}glCommonDefine.h"{}}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include "{}renderer.h"{}}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00009}00009 \textcolor{keyword}{namespace }ceres}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00010}00010 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00011}00011 GLFWRenderer::GLFWRenderer() :}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00012}00012     m\_frameRender([]() \{\}),}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00013}00013     m\_frameUpdate([](\textcolor{keywordtype}{float}) \{\}),}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00014}00014     m\_windowTitle(\textcolor{stringliteral}{"{}graphicRenderEngine"{}} + std::to\_string(Renderer::s\_rgVersionMajor) + \textcolor{stringliteral}{"{}."{}} + std::to\_string(Renderer::s\_rgVersionMinor) + \textcolor{stringliteral}{"{}."{}} + std::to\_string(Renderer::s\_rgVersionPoint))}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00015}00015 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00016}00016 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00017}00017 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00018}00018 GLFWRenderer::\string~GLFWRenderer()}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00019}00019 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00020}00020     \textcolor{keyword}{delete} m\_renderer;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00021}00021     m\_renderer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00022}00022     glfwTerminate();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00023}00023 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00025}00025 \textcolor{keywordtype}{void} GLFWRenderer::init(\textcolor{keywordtype}{bool} vsync)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00026}00026 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00027}00027     \textcolor{keywordflow}{if} (m\_running)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00028}00028     \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00029}00029         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00030}00030     \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00031}00031     \textcolor{keywordflow}{if} (!m\_window)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00032}00032     \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00033}00033         glfwInit();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00034}00034         glfwWindowHint(GLFW\_CONTEXT\_DEBUG, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00035}00035 \textcolor{preprocessor}{\#ifdef RE\_DEBUG\_CONTEXT}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00036}00036         glfwWindowHint(GLFW\_SRGB\_CAPABLE, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00037}00037 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00038}00038         glfwWindowHint(GLFW\_CONTEXT\_VERSION\_MAJOR, 4);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00039}00039         glfwWindowHint(GLFW\_CONTEXT\_VERSION\_MINOR, 1);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00040}00040         glfwWindowHint(GLFW\_OPENGL\_PROFILE, GLFW\_OPENGL\_CORE\_PROFILE);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00041}00041         glfwWindowHint(GLFW\_DEPTH\_BITS, ceres::Renderer::s\_depthBits);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00042}00042         glfwWindowHint(GLFW\_STENCIL\_BITS, ceres::Renderer::s\_stencilBits);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00043}00043 \textcolor{preprocessor}{\#ifdef \_\_APPLE\_\_}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00044}00044         glfwWindowHint(GLFW\_OPENGL\_FORWARD\_COMPAT, GL\_TRUE);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00045}00045 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00046}00046         \textcolor{comment}{// glfw window creation}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00047}00047         m\_window = glfwCreateWindow(m\_windowWidth, m\_windowHeight, m\_windowTitle.c\_str(), \textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00048}00048         glfwSetWindowUserPointer(m\_window, \textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00049}00049         glfwSetFramebufferSizeCallback(m\_window, [](GLFWwindow* window, \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height) \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00050}00050             \textcolor{keyword}{auto}* app = \textcolor{keyword}{reinterpret\_cast<}GLFWRenderer*\textcolor{keyword}{>}(glfwGetWindowUserPointer(window));}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00051}00051             app-\/>m\_frameResize(width, height);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00052}00052         \});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00053}00053         \textcolor{comment}{// 设置光标回调}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00054}00054         glfwSetCursorPosCallback(m\_window, [](GLFWwindow* window, \textcolor{keywordtype}{double} xPos, \textcolor{keywordtype}{double} yPos) \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00055}00055             \textcolor{keyword}{auto}* app = \textcolor{keyword}{reinterpret\_cast<}GLFWRenderer*\textcolor{keyword}{>}(glfwGetWindowUserPointer(window));}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00056}00056             app-\/>m\_cursorPosEvent(xPos, yPos);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00057}00057         \});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00058}00058         glfwSetMouseButtonCallback(m\_window, [](GLFWwindow* window, \textcolor{keywordtype}{int} button, \textcolor{keywordtype}{int} action, \textcolor{keywordtype}{int} mods) \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00059}00059             \textcolor{keyword}{auto}* app = \textcolor{keyword}{reinterpret\_cast<}GLFWRenderer*\textcolor{keyword}{>}(glfwGetWindowUserPointer(window));}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00060}00060             app-\/>m\_mouseButtonEvent(button, action, mods);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00061}00061         \});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00063}00063         glfwSetDropCallback(m\_window, [](GLFWwindow* window, \textcolor{keywordtype}{int} count, \textcolor{keyword}{const} \textcolor{keywordtype}{char}** paths) \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00064}00064             \textcolor{keyword}{auto}* app = \textcolor{keyword}{reinterpret\_cast<}GLFWRenderer*\textcolor{keyword}{>}(glfwGetWindowUserPointer(window));}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00065}00065             app-\/>m\_dropEvent(count, paths);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00066}00066         \});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00067}00067         \textcolor{keywordflow}{if} (m\_window == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00068}00068         \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00069}00069             glfwTerminate();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00070}00070         \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00071}00071         m\_renderer = \textcolor{keyword}{new} Renderer(m\_window, vsync);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00072}00072         glEnable(GL\_FRAMEBUFFER\_SRGB);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00073}00073     \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00074}00074 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00076}00076 \textcolor{keywordtype}{void} GLFWRenderer::setWindowTitle(std::string\_view title)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00077}00077 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00078}00078     m\_windowTitle = title;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00079}00079     \textcolor{keywordflow}{if} (m\_window != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00080}00080     \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00081}00081         glfwSetWindowTitle(m\_window, m\_windowTitle.c\_str());}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00082}00082     \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00083}00083 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00085}00085 \textcolor{keywordtype}{void} GLFWRenderer::setWindowSize(\textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00086}00086 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00087}00087     m\_windowWidth = width;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00088}00088     m\_windowHeight = height;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00089}00089     \textcolor{keywordflow}{if} (m\_window != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00090}00090     \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00091}00091         glfwSetWindowSize(m\_window, width, height);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00092}00092     \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00093}00093 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00095}00095 \textcolor{keywordtype}{void} GLFWRenderer::startEventLoop()}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00096}00096 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00097}00097     \textcolor{keywordflow}{if} (!m\_window)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00098}00098     \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00099}00099         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}GLFWRenderer::init() not called"{}});}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00100}00100     \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00101}00101     m\_running = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00102}00102     \textcolor{keyword}{typedef} std::chrono::high\_resolution\_clock Clock;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00103}00103     \textcolor{keyword}{using }FpSeconds = std::chrono::duration<float, std::chrono::seconds::period>;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00104}00104     \textcolor{keyword}{auto} lastTick = Clock::now();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00105}00105     \textcolor{keywordtype}{float} deltaTime = 0;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00106}00106     \textcolor{keywordflow}{while} (m\_running)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00107}00107     \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00108}00108         frame(deltaTime);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00109}00109         \textcolor{keyword}{auto} tick = Clock::now();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00110}00110         deltaTime = std::chrono::duration\_cast<FpSeconds>(tick -\/ lastTick).count();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00111}00111         lastTick = tick;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00112}00112     \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00113}00113 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00114}00114 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00115}00115 [[maybe\_unused]] \textcolor{keywordtype}{void} GLFWRenderer::stopEventLoop()}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00116}00116 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00117}00117     m\_running = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00118}00118 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00119}00119 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00120}00120 GLFWwindow* GLFWRenderer::getGlfwWindow()}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00121}00121 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00122}00122     \textcolor{keywordflow}{return} m\_window;}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00123}00123 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00125}00125 \textcolor{keywordtype}{void} GLFWRenderer::frame(\textcolor{keywordtype}{float} deltaTimeSec)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00126}00126 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00127}00127     \textcolor{keywordflow}{if} (glfwGetKey(m\_window, GLFW\_KEY\_Q) == GLFW\_PRESS || glfwGetKey(m\_window, GLFW\_KEY\_ESCAPE) == GLFW\_PRESS)}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00128}00128     \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00129}00129         m\_running = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00130}00130     \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00131}00131     m\_frameUpdate(deltaTimeSec);}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00132}00132     m\_frameRender();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00133}00133     m\_renderer-\/>swapWindow();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00134}00134 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00136}00136 glm::ivec2 GLFWRenderer::getFrameBufferSize()}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00137}00137 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00138}00138     \textcolor{keywordflow}{return} m\_renderer-\/>getFramebufferSize();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00139}00139 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00141}00141 glm::ivec2 GLFWRenderer::getWindowSize()}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00142}00142 \{}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00143}00143     \textcolor{keywordflow}{return} m\_renderer-\/>getWindowSize();}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00144}00144 \}}
\DoxyCodeLine{\Hypertarget{glfw_renderer_8cpp_source_l00145}00145 \} \textcolor{comment}{// namespace ceres}}

\end{DoxyCode}
